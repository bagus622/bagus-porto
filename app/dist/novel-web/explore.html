<!DOCTYPE html>
<html lang="id" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Explore - NovelHub</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <a href="index.html" class="logo">NovelHub</a>
    
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="explore.html" class="active">Explore</a></li>
      <li><a href="write.html">Write</a></li>
      <li><a href="my-novel.html">My Novel</a></li>
    </ul>
    
    <div class="nav-actions">
      <button class="theme-toggle" title="Toggle Dark Mode">üåô</button>
      <button class="mobile-menu-btn" title="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>

  <main>
    <section class="section container">
      <h1 class="section-title" style="margin-bottom: 1.5rem;">üìö Jelajahi Cerita</h1>
      
      <!-- Search Bar -->
      <div class="search-bar">
        <input 
          type="text" 
          class="search-input" 
          id="search-input" 
          placeholder="Cari judul novel..."
          onkeyup="searchNovels()"
        >
        <button class="btn btn-primary" onclick="searchNovels()">üîç Cari</button>
      </div>
      
      <!-- Genre Filter -->
      <div class="genre-tags" style="margin-bottom: 2rem;">
        <button class="genre-tag active" onclick="filterGenre('all')">Semua</button>
        <button class="genre-tag" onclick="filterGenre('Fantasi')">Fantasi</button>
        <button class="genre-tag" onclick="filterGenre('Romansa')">Romansa</button>
        <button class="genre-tag" onclick="filterGenre('Misteri')">Misteri</button>
        <button class="genre-tag" onclick="filterGenre('Horor')">Horor</button>
        <button class="genre-tag" onclick="filterGenre('Aksi')">Aksi</button>
        <button class="genre-tag" onclick="filterGenre('Komedi')">Komedi</button>
        <button class="genre-tag" onclick="filterGenre('Drama')">Drama</button>
      </div>
      
      <!-- Results Count -->
      <p id="results-count" style="color: var(--text-muted); margin-bottom: 1rem;"></p>
      
      <!-- Novel Grid -->
      <div class="card-grid" id="novel-grid">
        <!-- Diisi oleh JavaScript -->
      </div>
      
      <!-- Empty State -->
      <div id="empty-state" class="empty-state" style="display: none;">
        <div class="empty-state-icon">üì≠</div>
        <h3>Tidak ada novel ditemukan</h3>
        <p>Coba kata kunci lain atau jelajahi genre berbeda</p>
      </div>
    </section>
  </main>

  <script src="js/app.js"></script>
  <script>
    let currentGenre = 'all';
    let searchQuery = '';
    
    // Render novels
    function renderNovels() {
      const novels = getNovels();
      const grid = document.getElementById('novel-grid');
      const emptyState = document.getElementById('empty-state');
      const resultsCount = document.getElementById('results-count');
      
      // Filter novels
      let filtered = novels;
      
      // Filter by genre
      if (currentGenre !== 'all') {
        filtered = filtered.filter(n => n.genre === currentGenre);
      }
      
      // Filter by search query
      if (searchQuery) {
        filtered = filtered.filter(n => 
          n.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
          n.author.toLowerCase().includes(searchQuery.toLowerCase()) ||
          n.synopsis.toLowerCase().includes(searchQuery.toLowerCase())
        );
      }
      
      // Update results count
      resultsCount.textContent = `Menampilkan ${filtered.length} novel`;
      
      // Show/hide empty state
      if (filtered.length === 0) {
        grid.style.display = 'none';
        emptyState.style.display = 'block';
      } else {
        grid.style.display = 'grid';
        emptyState.style.display = 'none';
        
        // Render cards
        grid.innerHTML = filtered.map(novel => createNovelCard(novel)).join('');
      }
    }
    
    // Create novel card HTML
    function createNovelCard(novel) {
      const coverStyle = novel.cover 
        ? `background-image: url('${novel.cover}')` 
        : `background: ${generateRandomCover()}`;
      
      return `
        <div class="novel-card" onclick="location.href='novel.html?id=${novel.id}'">
          <div class="novel-card-cover" style="${coverStyle}; background-size: cover; background-position: center;"></div>
          <div class="novel-card-content">
            <h3 class="novel-card-title">${escapeHtml(novel.title)}</h3>
            <p class="novel-card-author">${escapeHtml(novel.author)}</p>
            <span class="novel-card-genre">${escapeHtml(novel.genre)}</span>
          </div>
        </div>
      `;
    }
    
    // Filter by genre
    function filterGenre(genre) {
      currentGenre = genre;
      
      // Update active tag
      document.querySelectorAll('.genre-tags .genre-tag').forEach(tag => {
        tag.classList.remove('active');
      });
      event.target.classList.add('active');
      
      renderNovels();
    }
    
    // Search novels
    function searchNovels() {
      searchQuery = document.getElementById('search-input').value.trim();
      renderNovels();
    }
    
    // Check URL params for genre filter
    function checkUrlParams() {
      const params = new URLSearchParams(window.location.search);
      const genre = params.get('genre');
      
      if (genre) {
        currentGenre = genre;
        
        // Update active tag
        document.querySelectorAll('.genre-tags .genre-tag').forEach(tag => {
          tag.classList.remove('active');
          if (tag.textContent === genre) {
            tag.classList.add('active');
          }
        });
      }
    }
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      checkUrlParams();
      renderNovels();
    });
  </script>
</body>
</html>
